<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meme Coin Chaos</title>

<style>
body{
  font-family:Arial;
  background:#111;
  color:white;
  text-align:center;
}

h1{ margin:10px; }

#stats{
  margin:10px;
}

.coin{
  border:1px solid #444;
  margin:8px auto;
  padding:8px;
  width:320px;
  background:#181818;
}

.coin h3{
  margin:4px;
}

button{
  margin:3px;
}

input{
  width:70px;
}

canvas{
  background:#000;
  margin-top:6px;
}
</style>
</head>
<body>

<h1>Meme Coin Chaos</h1>

<div id="stats">
  Cash: $<span id="cash">1000</span> |
  Net Worth: $<span id="networth">1000</span>
</div>

<div id="coins"></div>

<script>

const FEE = 0.01;
const MAX_HISTORY = 60;

let cash = 1000;

let coins = [
 {name:"DogeLordX", base:1, price:1, vol:0.02, holdings:0, staked:0, totalSpent:0, history:[]},
 {name:"QuantumPepe", base:2, price:2, vol:0.018, holdings:0, staked:0, totalSpent:0, history:[]},
 {name:"MoonRaccoon", base:0.5, price:0.5, vol:0.025, holdings:0, staked:0, totalSpent:0, history:[]}
];

function saveGame(){
  localStorage.setItem("memeSave", JSON.stringify({cash,coins}));
}

function loadGame(){
  let data = localStorage.getItem("memeSave");
  if(!data) return;
  let save = JSON.parse(data);
  cash = save.cash;
  coins = save.coins;
}

function renderCoins(){
  let container = document.getElementById("coins");
  container.innerHTML = "";

  coins.forEach((c,i)=>{
    container.innerHTML += `
      <div class="coin">
        <h3 id="name-${i}">${c.name}</h3>
        <div>Price: $<span id="price-${i}">${c.price.toFixed(2)}</span></div>
        <div>Liquid: <span id="hold-${i}">${c.holdings.toFixed(2)}</span></div>
        <div>Staked: <span id="stake-${i}">${c.staked.toFixed(2)}</span></div>

        <input id="qty-${i}" type="number" value="15">

        <div>
          <button onclick="buy(${i})">Buy</button>
          <button onclick="buyMax(${i})">Buy Max</button>
          <button onclick="sell(${i})">Sell</button>
          <button onclick="sellMax(${i})">Sell Max</button>
        </div>

        <div>
          <button onclick="stake(${i})">Stake</button>
          <button onclick="unstake(${i})">Unstake</button>
        </div>

        <canvas id="chart-${i}" width="300" height="80"></canvas>
      </div>
    `;
  });
}

function updateUI(){
  let net = cash;

  coins.forEach((c,i)=>{
    net += (c.holdings + c.staked) * c.price;

    document.getElementById(`price-${i}`).innerText = c.price.toFixed(2);
    document.getElementById(`hold-${i}`).innerText = c.holdings.toFixed(2);
    document.getElementById(`stake-${i}`).innerText = c.staked.toFixed(2);
  });

  document.getElementById("cash").innerText = cash.toFixed(2);
  document.getElementById("networth").innerText = net.toFixed(2);

  drawCharts();
  saveGame();
}

function buy(i){
  let input = document.getElementById(`qty-${i}`);
  let qty = parseFloat(input.value);
  if(!qty || qty<=0) return;

  let totalCost = qty * coins[i].price * (1+FEE);

  if(totalCost > cash){
    qty = cash / (coins[i].price*(1+FEE));
  }

  if(qty<=0) return;

  let cost = qty * coins[i].price;
  let fee = cost * FEE;

  cash -= (cost+fee);
  coins[i].holdings += qty;
  coins[i].totalSpent += (cost+fee);

  input.value = 15;

  updateUI();
}

function buyMax(i){
  let qty = cash / (coins[i].price*(1+FEE));
  if(qty<=0) return;

  let cost = qty * coins[i].price;
  let fee = cost * FEE;

  cash -= (cost+fee);
  coins[i].holdings += qty;
  coins[i].totalSpent += (cost+fee);

  updateUI();
}

function sell(i){
  let input = document.getElementById(`qty-${i}`);
  let qty = parseFloat(input.value);
  if(!qty || qty<=0) return;

  if(qty > coins[i].holdings) qty = coins[i].holdings;

  let gross = qty * coins[i].price;
  let fee = gross * FEE;

  cash += (gross-fee);
  coins[i].holdings -= qty;

  input.value = 15;

  updateUI();
}

function sellMax(i){
  let qty = coins[i].holdings;
  if(qty<=0) return;

  let gross = qty * coins[i].price;
  let fee = gross * FEE;

  cash += (gross-fee);
  coins[i].holdings = 0;

  updateUI();
}

function stake(i){
  let qty = parseFloat(document.getElementById(`qty-${i}`).value);
  if(!qty || qty<=0) return;
  if(qty>coins[i].holdings) qty = coins[i].holdings;

  coins[i].holdings -= qty;
  coins[i].staked += qty;

  updateUI();
}

function unstake(i){
  let qty = parseFloat(document.getElementById(`qty-${i}`).value);
  if(!qty || qty<=0) return;
  if(qty>coins[i].staked) qty = coins[i].staked;

  coins[i].staked -= qty;
  coins[i].holdings += qty;

  updateUI();
}

function updatePrices(){
  coins.forEach(c=>{
    let meanPull = (c.base - c.price)*0.002;
    let shock = (Math.random()-0.5)*c.vol;
    c.price += (meanPull + shock)*c.price;

    if(c.price<0.01) c.price=0.01;

    c.history.push(c.price);
    if(c.history.length>MAX_HISTORY) c.history.shift();
  });

  updateUI();
}

function drawCharts(){
  coins.forEach((c,i)=>{
    let canvas = document.getElementById(`chart-${i}`);
    let ctx = canvas.getContext("2d");
    ctx.clearRect(0,0,canvas.width,canvas.height);

    if(c.history.length<2) return;

    let max = Math.max(...c.history);
    let min = Math.min(...c.history);
    let range = max-min || 1;

    ctx.beginPath();

    c.history.forEach((price,index)=>{
      let x = (index/c.history.length)*canvas.width;
      let y = canvas.height - ((price-min)/range)*canvas.height;

      if(index===0) ctx.moveTo(x,y);
      else ctx.lineTo(x,y);
    });

    ctx.strokeStyle =
      c.history[c.history.length-1] >
      c.history[c.history.length-2] ? "lime" : "red";

    ctx.stroke();
  });
}

loadGame();
renderCoins();
setInterval(updatePrices,1000);
updateUI();

</script>
</body>
</html>
